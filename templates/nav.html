<!-- JobHunter3000 Navigation Bar -->

<nav class="main-nav">
    <a href="/settings" class="{% if active == 'settings' %}active{% endif %}">Settings</a>
    <a href="/resumes" class="{% if active == 'resumes' %}active{% endif %}">Arsenal</a>
    <a href="/profile" class="{% if active == 'profile' %}active{% endif %}">Dossier</a>
    <div class="nav-divider"></div>
    <a href="/scraper" class="{% if active == 'scraper' %}active{% endif %}">Recon</a>
    <a href="/jobs" class="{% if active == 'jobs' %}active{% endif %}">Intel</a>
    <a href="/pipeline" class="{% if active == 'pipeline' %}active{% endif %}">Pipeline</a>
    <a href="/dashboard" class="{% if active == 'dashboard' %}active{% endif %}">Mission Control</a>

    <!-- OpenRouter Credits -->
    <div id="topbar-credits" onclick="refreshTopbarCredits()" title="Click to refresh OpenRouter balance"
         style="cursor: pointer; font-size: 13px; font-weight: 600; color: #666;
                padding: 5px 12px; border-radius: 6px; background: rgba(255,255,255,0.03);
                border: 1px solid var(--border); margin-left: 8px;
                transition: all 0.15s; display: none; white-space: nowrap;">
        <span style="font-size: 10px; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); margin-right: 4px;">OR</span>
        <span id="topbar-credits-val">...</span>
    </div>
</nav>

<script>
(function() {
    var POLL = 300000;
    var WARN = 10;
    var CRIT = 2;

    function fetchCredits() {
        var wrap = document.getElementById('topbar-credits');
        var el = document.getElementById('topbar-credits-val');
        if (!wrap || !el) return;
        fetch('/api/openrouter/credits').then(function(r) { return r.json(); }).then(function(data) {
            if (!data.ok) { wrap.style.display = 'none'; return; }
            var r = data.remaining;
            wrap.style.display = '';
            el.textContent = '$' + (r >= 1 ? r.toFixed(2) : r.toFixed(3));
            if (r > WARN) { el.style.color = '#4ade80'; }
            else if (r > CRIT) { el.style.color = '#fbbf24'; }
            else { el.style.color = '#f87171'; }
        }).catch(function() { wrap.style.display = 'none'; });
    }

    window.refreshTopbarCredits = function() {
        var el = document.getElementById('topbar-credits-val');
        if (el) { el.textContent = '...'; el.style.color = '#666'; }
        fetchCredits();
    };

    fetchCredits();
    setInterval(fetchCredits, POLL);
})();
</script>
